---
title: Piecewise Exact Method
author: Ajit Devkota
date: 2022-04-1 20:55:00 +0800
#categories: [PEM]
tags: [PEM]
pin: false
---

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
</script>

### Overview: 
In this post, the Piecewise Exact method is covered.

To use this method, consider an input waveform of frequency 1Hz sampled at 0.01 sec. We want to determine the displacement response using PEM.

<p align="left"> <img src = "/_posts/2022-04-01-PEM/1hz.png" width = "" style="background-color:white;"> </p>

### Formulation:
The following summarizes the relevent formula used. [Humar]

$$ u_{n+1} = A\:u_n + B\:\dot{u}_{n} +C\:p_n + D\:p_{n+1} $$


$$ \dot{u}_{n+1} = A_1\:u_n + B_1\:\dot{u}_n + C_1\:p_n + D_1\:p_{n+1} $$


where,

\begin{equation}
A = e^{-\xi\omega_nh}\left[\frac{\xi}{\sqrt{1-\xi^2}}\sin(\omega_dh) + \cos(\omega_dh) \right]
\end{equation}

\begin{equation}
B=e^{-\xi\omega_nh}\left[\frac{1}{\omega_d}\sin(\omega_dh) \right]
\end{equation}

\begin{equation}
C=\frac{1}{k}\left[\frac{2\xi}{\omega_nh} + e^{-\xi\omega_nh}\left(\left(\frac{1-2\xi^2}{\omega_dh} - \frac{\xi}{\sqrt{1-\xi^2}} \right)\sin(\omega_dh)-\left(1+\frac{2\xi}{\omega_n h} \right)\cos(\omega_dh)\right) \right]
\end{equation}

\begin{equation}
D=\frac{1}{k}\left[1-\frac{2\xi}{\omega_nh}+e^{-\xi\omega_nh}\left(\frac{2\xi^2-1}{\omega_dh}\sin(\omega_dh) + \frac{2\xi}{\omega_nh}\cos(\omega_dh) \right) \right]
\end{equation}

\begin{equation}
A_1=-e^{-\xi\omega_nh}\left[\frac{\omega_n}{\sqrt{1-\xi^2}}\sin(\omega_dh) \right]
\end{equation}

\begin{equation}
B_1=e^{-\xi\omega_nh}\left[\cos(\omega_dh)-\frac{\xi}{\sqrt{1-\xi^2}}\sin(\omega_dh) \right]
\end{equation}

\begin{equation}
C_1=\frac{1}{k}\left[-\frac{1}{h} + e^{-\xi\omega_nh}\left(\left(\frac{\omega_n}{\sqrt{1-\xi^2}} + \frac{\xi}{h\sqrt{1-\xi^2}} \right)\sin(\omega_dh) +\frac{1}{h}\cos(\omega_d h) \right) \right]
\end{equation}

\begin{equation}
D_1=\frac{1}{k}\left[\frac{1}{h} - \frac{e^{-\xi\omega_nh}}{h} \left(\frac{\xi}{\sqrt{1-\xi^2}}\sin(\omega_dh)+\cos(\omega_dh) \right)\right]
\end{equation}

### Code:

<script src="https://gist.github.com/ajitdevkota/f5918eb991b23f472db004cf27020d78.js"></script>

### Example Response:
The following response is obtained:

<p align="left"> <img src = "/_posts/2022-04-01-PEM/pem_response.png" width = "" style="background-color:white;"> </p>
